<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Qu√≠mico Maestro</title>
    <style>
        :root {
            --bg: #0a0e14; --card: #161b22; --accent: #58a6ff;
            --danger: #f85149; --warning: #d29922; --safe: #3fb950;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: #c9d1d9; margin: 0; padding: 10px; }
        .app { max-width: 600px; margin: auto; }
        
        /* Estante de Qu√≠micos */
        .shelf { background: var(--card); padding: 15px; border-radius: 12px; border: 1px solid #30363d; margin-bottom: 15px; }
        .chemical-item { display: inline-flex; align-items: center; background: #21262d; padding: 5px 10px; border-radius: 8px; margin: 4px; border: 1px solid #30363d; cursor: pointer; }
        .chemical-item.selected { border-color: var(--accent); background: #1f2937; }
        .info-btn { background: var(--accent); color: white; border: none; border-radius: 50%; width: 18px; height: 18px; font-size: 12px; margin-left: 8px; cursor: help; display: flex; align-items: center; justify-content: center; }

        /* Zona de Mezcla */
        .lab-zone { text-align: center; padding: 20px; border: 2px dashed #30363d; border-radius: 15px; margin-bottom: 15px; }
        .mix-btn { background: var(--safe); color: white; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; font-size: 1.1rem; cursor: pointer; margin-top: 10px; }
        .mix-btn:disabled { background: #21262d; cursor: not-allowed; }

        /* Resultado y Recetas */
        .result-box { display: none; background: var(--card); padding: 20px; border-radius: 12px; border-left: 10px solid #ccc; animation: slideIn 0.3s; margin-bottom: 15px; }
        .recipe-book { background: #0d1117; padding: 15px; border-radius: 12px; border: 1px solid var(--accent); }
        
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .danger-badge { padding: 5px 15px; border-radius: 5px; font-weight: bold; margin-bottom: 10px; display: inline-block; }
    </style>
</head>
<body>

<div class="app">
    <h2 style="text-align:center; color: var(--accent);">üß™ Lab Maestro Pro</h2>
    
    <div class="shelf">
        <p style="margin-top:0; font-size:0.9rem;">Toca para seleccionar qu√≠micos (puedes elegir varios):</p>
        <div id="chemical-list"></div>
    </div>

    <div class="lab-zone">
        <div id="selection-display">Ning√∫n qu√≠mico seleccionado</div>
        <button class="mix-btn" id="btn-mezclar" onclick="mezclar()" disabled>MEZCLAR AHORA</button>
        <button onclick="limpiar()" style="background:none; border:none; color:var(--danger); cursor:pointer; font-size:0.8rem;">Limpiar Mesa</button>
    </div>

    <div id="resultado" class="result-box"></div>

    <div class="recipe-book">
        <h4 style="margin:0 0 10px 0;">üìî Recetas Descubiertas / Guardadas</h4>
        <div id="saved-recipes" style="font-size: 0.85rem; opacity: 0.8;">A√∫n no has guardado nada.</div>
    </div>
</div>

<script>
    // BASE DE DATOS EXTENSA
    const chemicals = {
        "Lavandina": { skin: "Quema la piel.", breath: "Irritaci√≥n pulmonar severa.", ingest: "Corrosivo interno. Grave.", storage: "Lugar fresco, envase pl√°stico." },
        "Amon√≠aco": { skin: "C√°ustico.", breath: "Asfixiante fuerte.", ingest: "V√≥mitos y quemaduras.", storage: "Ventilaci√≥n alta." },
        "Vinagre": { skin: "Irritaci√≥n leve.", breath: "Olor punzante.", ingest: "Seguro en poca dosis.", storage: "Cualquier envase." },
        "Nafta": { skin: "Reseca y da√±a.", breath: "Mareos y alucinaciones.", ingest: "T√≥xico fatal.", storage: "Metal o HDPE aprobado." },
        "Aluminio (Papel)": { skin: "Inerte.", breath: "Polvo peligroso.", ingest: "Obstrucci√≥n.", storage: "Seco." },
        "Sosa C√°ustica": { skin: "Disuelve tejidos (Grave).", breath: "Polvo corrosivo.", ingest: "Letal.", storage: "Pl√°stico grueso, seco." },
        "√Åcido Muri√°tico": { skin: "Quemadura √°cida instant√°nea.", breath: "Humos que disuelven dientes/pulm√≥n.", ingest: "Destruye es√≥fago.", storage: "Vidrio o pl√°stico especial." },
        "Azufre": { skin: "Dermatitis.", breath: "Tos seca.", ingest: "T√≥xico.", storage: "Lejos de fuego." },
        "Salitre": { skin: "Irritaci√≥n.", breath: "Estornudos.", ingest: "Dolor estomacal.", storage: "Bolsa herm√©tica." },
        "Carb√≥n": { skin: "Ensucia.", breath: "Da√±o a largo plazo.", ingest: "Indigesti√≥n.", storage: "Lugar seco." }
    };

    const reactions = [
        { items: ["Lavandina", "Amon√≠aco"], name: "Gas Cloramina", danger: "EXTREMO üî¥", desc: "Gas t√≥xico mortal. Ataca pulmones.", color: "#ff5252" },
        { items: ["Lavandina", "Vinagre"], name: "Gas Cloro", danger: "ALTO üü†", desc: "Gas verde que quema ojos y garganta.", color: "#ffa726" },
        { items: ["Aluminio (Papel)", "Sosa C√°ustica"], name: "Gas Hidr√≥geno", danger: "EXPLOSIVO üß®", desc: "Libera calor extremo y gas que explota con chispas.", color: "#f44336" },
        { items: ["Azufre", "Salitre", "Carb√≥n"], name: "P√≥lvora Negra", danger: "INFLAMABLE üî•", desc: "Deflagraci√≥n r√°pida. Uso: Pirotecnia.", color: "#795548" },
        { items: ["√Åcido Muri√°tico", "Aluminio (Papel)"], name: "Cloruro de Aluminio + H2", danger: "PELIGRO ‚ò¢Ô∏è", desc: "Reacci√≥n violenta con mucho calor y gases.", color: "#607d8b" }
    ];

    let selectedItems = [];
    let discovered = JSON.parse(localStorage.getItem('quimica_descubierta')) || [];

    function renderChemicals() {
        const container = document.getElementById('chemical-list');
        Object.keys(chemicals).forEach(name => {
            const div = document.createElement('div');
            div.className = 'chemical-item';
            div.innerHTML = `${name} <button class="info-btn" onclick="showInfo(event, '${name}')">?</button>`;
            div.onclick = () => selectItem(name, div);
            container.appendChild(div);
        });
        updateSavedDisplay();
    }

    function showInfo(event, name) {
        event.stopPropagation();
        const info = chemicals[name];
        alert(`INFO SEGURIDAD - ${name}:\n\nüëÉ Respirar: ${info.breath}\n‚úã Piel: ${info.skin}\nüëÑ Ingerir: ${info.ingest}\nüì¶ Almacenaje: ${info.storage}`);
    }

    function selectItem(name, element) {
        if (selectedItems.includes(name)) {
            selectedItems = selectedItems.filter(i => i !== name);
            element.classList.remove('selected');
        } else {
            selectedItems.push(name);
            element.classList.add('selected');
        }
        document.getElementById('selection-display').innerText = selectedItems.length > 0 ? selectedItems.join(' + ') : "Ning√∫n qu√≠mico seleccionado";
        document.getElementById('btn-mezclar').disabled = selectedItems.length < 2;
    }

    function mezclar() {
        const resBox = document.getElementById('resultado');
        const match = reactions.find(r => 
            r.items.length === selectedItems.length && 
            r.items.every(i => selectedItems.includes(i))
        );

        resBox.style.display = "block";
        if (match) {
            resBox.style.borderLeftColor = match.color;
            resBox.innerHTML = `
                <div class="danger-badge" style="background:${match.color}">DIFICULTAD: ${match.danger}</div>
                <h3>Resultante: ${match.name}</h3>
                <p>${match.desc}</p>
                <button onclick="guardarMezcla('${match.name}', '${selectedItems.join('+')}')">üíæ Guardar Receta</button>
            `;
        } else {
            resBox.style.borderLeftColor = "#555";
            resBox.innerHTML = `
                <div class="danger-badge" style="background:#555">RANGO: DESCONOCIDO ‚ùì</div>
                <h3>Mezcla Indeterminada</h3>
                <p>No hay datos sobre esta mezcla exacta. ¬°CUIDADO! Puede ser inestable o producir calor imprevisto.</p>
            `;
        }
    }

    function guardarMezcla(nombre, combo) {
        if (!discovered.some(d => d.combo === combo)) {
            discovered.push({ nombre, combo });
            localStorage.setItem('quimica_descubierta', JSON.stringify(discovered));
            updateSavedDisplay();
            alert("Receta guardada en tu libro.");
        }
    }

    function updateSavedDisplay() {
        const container = document.getElementById('saved-recipes');
        if (discovered.length === 0) return;
        container.innerHTML = discovered.map(d => `<div>‚úÖ <b>${d.nombre}</b>: <small>${d.combo}</small></div>`).join('');
    }

    function limpiar() {
        selectedItems = [];
        document.querySelectorAll('.chemical-item').forEach(el => el.classList.remove('selected'));
        document.getElementById('selection-display').innerText = "Ning√∫n qu√≠mico seleccionado";
        document.getElementById('resultado').style.display = "none";
        document.getElementById('btn-mezclar').disabled = true;
    }

    renderChemicals();
</script>

</body>
</html>
