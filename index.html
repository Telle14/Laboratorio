<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ChemMix Ultra Pro 6.0 - Master Edition</title>
    <style>
        :root {
            --bg: #010409; --card: #0d1117; --border: #30363d;
            --accent: #58a6ff; --danger: #f85149; --warning: #d29922;
            --safe: #3fb950; --info: #bc8cff; --text: #c9d1d9;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: -apple-system, system-ui, "Segoe UI", Helvetica, Arial, sans-serif;
            background: var(--bg); color: var(--text); margin: 0; padding: 10px;
            font-size: 11px; line-height: 1.3;
        }
        h1 { font-size: 14px; text-align: center; color: var(--accent); margin: 0 0 5px 0; }

        /* BUSCADOR */
        .search-container { margin-bottom: 10px; }
        #search-input {
            width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border);
            background: var(--card); color: white; font-size: 13px; outline: none;
        }
        #search-input:focus { border-color: var(--accent); }

        .app-grid { display: flex; flex-direction: column; gap: 8px; max-width: 600px; margin: auto; }

        /* LISTA QU√çMICOS */
        .shelf-container { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 8px; }
        .chemical-list {
            display: grid; grid-template-columns: 1fr 1fr; gap: 4px;
            max-height: 280px; overflow-y: auto; padding-right: 2px;
        }
        .chem-card {
            background: #161b22; border: 1px solid var(--border);
            padding: 8px; border-radius: 6px; display: flex;
            align-items: center; justify-content: space-between;
        }
        .chem-card.active { border-color: var(--accent); background: #1f2937; }
        .chem-card.hidden { display: none; }
        
        .q-btn {
            width: 20px; height: 20px; border-radius: 50%; border: 1px solid var(--info);
            background: none; color: var(--info); font-size: 11px; 
            display: flex; align-items: center; justify-content: center;
        }

        /* REACTOR */
        .reactor { background: var(--card); border: 1px dashed var(--border); border-radius: 12px; padding: 12px; text-align: center; }
        .mix-master-btn {
            width: 100%; padding: 14px; border: none; border-radius: 8px;
            background: var(--safe); color: white; font-weight: 800;
            font-size: 14px; text-transform: uppercase; cursor: pointer;
        }
        .mix-master-btn:disabled { background: #21262d; color: #484f58; }

        /* RESULTADOS */
        .result-pane {
            display: none; background: #0d1117; border: 1px solid var(--border);
            border-radius: 8px; padding: 12px; border-left: 4px solid var(--accent);
            margin-top: 10px;
        }
        .emergency-blink { animation: blinker 0.5s linear infinite; }
        @keyframes blinker { 50% { border-color: var(--danger); background: #3a0000; } }
        
        /* MODAL */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 9999;
        }
        .modal-content {
            background: var(--card); width: 90%; max-height: 85%;
            border-radius: 12px; border: 1px solid var(--accent); padding: 15px; overflow-y: auto;
        }
        .close-x { float: right; color: var(--danger); font-size: 20px; cursor: pointer; }

        .recipe-item { background: #161b22; padding: 6px; border-radius: 4px; margin-top: 4px; border-left: 2px solid var(--safe); }
    </style>
</head>
<body>

<div class="app-grid">
    <h1>CHEMMIX MASTER PRO</h1>

    <div class="search-container">
        <input type="text" id="search-input" placeholder="Buscar qu√≠mico (ej: carbon, sosa...)" onkeyup="filterChemicals()">
    </div>

    <div class="shelf-container">
        <div class="chemical-list" id="list"></div>
    </div>

    <div class="reactor">
        <div id="selection-display" style="font-size: 10px; color: #8b949e; margin-bottom: 8px;">Selecciona reactivos...</div>
        <button class="mix-master-btn" id="mix-btn" disabled onclick="handleMix()">MEZCLAR AHORA</button>
        <button onclick="resetLab()" style="background:none; border:none; color:var(--danger); font-size:10px; margin-top:8px;">Limpiar Laboratorio</button>
    </div>

    <div id="result-box" class="result-pane"></div>

    <div class="shelf-container">
        <span style="font-weight:bold; color:var(--safe)">‚úÖ RECETAS DESCUBIERTAS</span>
        <div id="saved-recipes"></div>
    </div>
</div>

<div id="modal" class="modal">
    <div class="modal-content">
        <span class="close-x" onclick="closeInfo()">√ó</span>
        <div id="modal-data"></div>
    </div>
</div>

<script>
    // BASE DE DATOS MASIVA (50 ELEMENTOS)
    const DB = {
        "Acido Sulfurico": { tipo: "Liquido viscoso", cont: "Vidrio/PEAD", color: "Incoloro", skin: "Carbonizacion inmediata", air: "Edema pulmonar", ingest: "Mortal", uso: "Baterias", prev: "Traje protector" },
        "Sodio Metalico": { tipo: "Solido blando", cont: "Aceite Mineral", color: "Plateado", skin: "Quemadura termica", air: "Irritante", ingest: "Explosivo", uso: "Industria", prev: "Pinzas secas" },
        "Acido Nitrico": { tipo: "Liquido humeante", cont: "Vidrio", color: "Amarillento", skin: "Manchas amarillas corrosivas", air: "Gases NO2", ingest: "Letal", uso: "Explosivos", prev: "Filtro gases" },
        "Glicerina": { tipo: "Liquido viscoso", cont: "Plastico", color: "Transparente", skin: "Seguro", air: "Seguro", ingest: "Seguro", uso: "Cosmetica", prev: "No oxidantes" },
        "Sosa Caustica": { tipo: "Escamas/Solido", cont: "Plastico", color: "Blanco", skin: "Disuelve grasa", air: "Corrosivo", ingest: "Mortal", uso: "Limpieza", prev: "Gafas" },
        "Permanganato de Potasio": { tipo: "Cristales", cont: "Vidrio oscuro", color: "Purpura", skin: "Mancha", air: "Irritante", ingest: "Toxico", uso: "Desinfectante", prev: "Lejos de glicerina" },
        "Fosforo Blanco": { tipo: "Solido cereo", cont: "Agua", color: "Amarillo", skin: "Quemadura osea", air: "Humo letal", ingest: "Mortal", uso: "Incendiario", prev: "Sin aire" },
        "Mercurio": { tipo: "Metal liquido", cont: "Vidrio grueso", color: "Plateado", skin: "Absorcion", air: "Neurotoxico", ingest: "Venenoso", uso: "Medicion", prev: "Hermetico" },
        "Acido Fluorhidrico": { tipo: "Liquido", cont: "Plastico especial", color: "Incoloro", skin: "Ataca huesos", air: "Letal", ingest: "Paro cardiaco", uso: "Vidrio", prev: "Traje especial" },
        "Cloro Gaseoso": { tipo: "Gas", cont: "Tanque acero", color: "Verde", skin: "Ampollas", air: "Asfixia", ingest: "N/A", uso: "Guerra/Piscina", prev: "Mascara" },
        "Magnesio": { tipo: "Cinta", cont: "Seco", color: "Gris", skin: "Seguro", air: "Humo metalico", ingest: "N/A", uso: "Luz", prev: "Sin agua" },
        "Acetona": { tipo: "Liquido", cont: "Metal", color: "Incoloro", skin: "Reseca", air: "Mareo", ingest: "Toxico", uso: "Solvente", prev: "Antichispas" },
        "Peroxido de Hidrogeno": { tipo: "Liquido", cont: "Venteado", color: "Incoloro", skin: "Blanquea/Quema", air: "Irritante", ingest: "Grave", uso: "Cohetes", prev: "Frio" },
        "Amoniaco": { tipo: "Liquido/Gas", cont: "Plastico", color: "Incoloro", skin: "Caustico", air: "Asfixiante", ingest: "Grave", uso: "Limpieza", prev: "Mascara" },
        "Cianuro de Potasio": { tipo: "Polvo", cont: "Caja fuerte", color: "Blanco", skin: "Letal", air: "Mortal", ingest: "Instantaneo", uso: "Mineria", prev: "Protocolo" },
        "Litio": { tipo: "Metal", cont: "Aceite", color: "Gris", skin: "Quema", air: "Irrita", ingest: "Grave", uso: "Baterias", prev: "Seco" },
        "Azufre": { tipo: "Polvo", cont: "Bolsa", color: "Amarillo", skin: "Leve", air: "Asfixiante quemado", ingest: "Toxico", uso: "Polvora", prev: "Lejos fuego" },
        "Salitre": { tipo: "Sal", cont: "Bolsa", color: "Blanco", skin: "Nulo", air: "Nulo", ingest: "Grave", uso: "Conservas", prev: "Seco" },
        "Carbon": { tipo: "Polvo", cont: "Bolsa", color: "Negro", skin: "Ensucia", air: "Da√±a pulmon", ingest: "Antidoto", uso: "Filtros", prev: "N/A" },
        "Acido Muriatico": { tipo: "Liquido", cont: "Plastico", color: "Amarillo", skin: "Corrosivo", air: "Irritante", ingest: "Letal", uso: "Obra", prev: "Gafas" },
        "Metanol": { tipo: "Liquido", cont: "Lata", color: "Incoloro", skin: "Absorcion", air: "Ceguera", ingest: "Muerte", uso: "Combustible", prev: "No respirar" },
        "Yodo": { tipo: "Solido", cont: "Vidrio", color: "Violeta", skin: "Mancha", air: "Da√±a tiroides", ingest: "Grave", uso: "Salud", prev: "Hermetico" },
        "Cal Viva": { tipo: "Piedra", cont: "Saco", color: "Blanco", skin: "Deshidrata", air: "Da√±a", ingest: "Quema", uso: "Obra", prev: "Sin agua" },
        "Etanol": { tipo: "Liquido", cont: "Plastico", color: "Incoloro", skin: "Seguro", air: "Borrachera", ingest: "Embriaga", uso: "Salud", prev: "Fuego" },
        "Cloroformo": { tipo: "Liquido", cont: "Vidrio oscuro", color: "Incoloro", skin: "Irrita", air: "Duerma/Mata", ingest: "Grave", uso: "Lab", prev: "No oler" },
        "Benceno": { tipo: "Liquido", cont: "Metal", color: "Incoloro", skin: "Cancer", air: "Leucemia", ingest: "Muerte", uso: "Quimica", prev: "Traje" },
        "Tolueno": { tipo: "Liquido", cont: "Metal", color: "Incoloro", skin: "Irrita", air: "Droga", ingest: "Grave", uso: "Pegamento", prev: "Ventilado" },
        "Formaldehido": { tipo: "Liquido", cont: "Vidrio", color: "Incoloro", skin: "Dureza", air: "Cancer", ingest: "Grave", uso: "Cadaveres", prev: "Mascara" },
        "Bicarbonato de Sodio": { tipo: "Polvo", cont: "Bolsa", color: "Blanco", skin: "Nulo", air: "Nulo", ingest: "Seguro", uso: "Cocina", prev: "N/A" },
        "Vinagre": { tipo: "Liquido", cont: "Botella", color: "Incoloro", skin: "Nulo", air: "Nulo", ingest: "Seguro", uso: "Comida", prev: "N/A" },
        "Lavandina": { tipo: "Liquido", cont: "Plastico", color: "Verde", skin: "Irrita", air: "Tos", ingest: "Grave", uso: "Limpieza", prev: "No mezclar" },
        "Aguarras": { tipo: "Liquido", cont: "Lata", color: "Incoloro", skin: "Dermatitis", air: "Mareo", ingest: "Mortal", uso: "Pintura", prev: "Gafas" },
        "Acido Oxalico": { tipo: "Cristales", cont: "Plastico", color: "Blanco", skin: "Quema", air: "Irrita", ingest: "Da√±a ri√±on", uso: "Maderas", prev: "Guantes" },
        "Borax": { tipo: "Polvo", cont: "Caja", color: "Blanco", skin: "Nulo", air: "Nulo", ingest: "Vomito", uso: "Slime", prev: "N/A" },
        "Plomo": { tipo: "Metal", cont: "Caja", color: "Gris", skin: "Seguro", air: "Da√±a", ingest: "Plumbosis", uso: "Pesas", prev: "Lavar manos" },
        "Acido Citrico": { tipo: "Polvo", cont: "Bolsa", color: "Blanco", skin: "Arde", air: "Nulo", ingest: "Agrio", uso: "Comida", prev: "N/A" },
        "Nitrocelulosa": { tipo: "Algodon", cont: "Humedo", color: "Blanco", skin: "Nulo", air: "Nulo", ingest: "N/A", uso: "Magia", prev: "No secar" },
        "Eter Etilico": { tipo: "Liquido", cont: "Oscuro", color: "Incoloro", skin: "Frio", air: "Anestesia", ingest: "Fatal", uso: "Operaciones", prev: "Explosivo" },
        "Fosforo Rojo": { tipo: "Polvo", cont: "Frasco", color: "Rojo", skin: "Seguro", air: "Toxico", ingest: "Grave", uso: "Fosforos", prev: "Cerrado" },
        "Calcio": { tipo: "Metal", cont: "Argon", color: "Gris", skin: "Quema", air: "Irrita", ingest: "Grave", uso: "Huesos", prev: "Seco" },
        "Acido Tartarico": { tipo: "Polvo", cont: "Bolsa", color: "Blanco", skin: "Nulo", air: "Nulo", ingest: "Seguro", uso: "Cocina", prev: "N/A" },
        "Hidroxido de Bario": { tipo: "Polvo", cont: "Frasco", color: "Blanco", skin: "Quema", air: "Venenoso", ingest: "Paralisis", uso: "Lab", prev: "Guantes" },
        "Nitrogeno Liquido": { tipo: "Liquido", cont: "Termo", color: "Incoloro", skin: "Congela", air: "Asfixia", ingest: "Muerte", uso: "Verrugas", prev: "Guantes" },
        "Hierro": { tipo: "Polvo", cont: "Bolsa", color: "Negro", skin: "Nulo", air: "Nulo", ingest: "N/A", uso: "Imanes", prev: "N/A" },
        "Permanganato de Sodio": { tipo: "Liquido", cont: "Vidrio", color: "Rojo", skin: "Mancha", air: "Irrita", ingest: "Grave", uso: "Oxidante", prev: "Cuidado" },
        "Acido Cromico": { tipo: "Liquido", cont: "Vidrio", color: "Rojo", skin: "Cancer", air: "Cancer", ingest: "Mortal", uso: "Metales", prev: "Traje" },
        "Butano": { tipo: "Gas", cont: "Garrafa", color: "Incoloro", skin: "Congela", air: "Asfixia", ingest: "N/A", uso: "Fuego", prev: "No fumar" },
        "Trementina": { tipo: "Liquido", cont: "Lata", color: "Amarillo", skin: "Alergia", air: "Asma", ingest: "Mortal", uso: "Arte", prev: "Fresco" },
        "Grafito": { tipo: "Polvo", cont: "Bolsa", color: "Gris", skin: "Ensucia", air: "Nulo", ingest: "Seguro", uso: "Lapiz", prev: "N/A" },
        "Hielo Seco": { tipo: "Solido", cont: "Nevera", color: "Blanco", skin: "Congela", air: "Asfixia", ingest: "Muerte", uso: "Efectos", prev: "Gafas" }
    };

    // MOTOR DE REACCIONES (M√°s de 100 combinaciones posibles)
    const REACTIONS = [
        { items: ["Lavandina", "Amoniaco"], name: "Gas Cloramina", danger: "CRITICO üî¥", desc: "Gas mortal asfixiante." },
        { items: ["Acido Sulfurico", "Azufre", "Salitre"], name: "Polvora Acida", danger: "EXPLOSIVO üß®", desc: "Combustion violenta extrema." },
        { items: ["Glicerina", "Permanganato de Potasio"], name: "Fuego Espontaneo", danger: "FUEGO üî•", desc: "Ignicion termica purpura." },
        { items: ["Sodio Metalico", "Acido Muriatico"], name: "Explosion de Hidrogeno", danger: "LETAL ‚ò£Ô∏è", desc: "Detonacion y salpicadura acida." },
        { items: ["Acetona", "Peroxido de Hidrogeno"], name: "TATP (Explosivo)", danger: "MORTAL üí£", desc: "Cristales ultra sensibles al tacto." },
        { items: ["Acido Nitrico", "Glicerina"], name: "Nitroglicerina", danger: "ANANIAS üíÄ", desc: "Explosivo liquido inestable." },
        { items: ["Acido Sulfurico", "Peroxido de Hidrogeno"], name: "Solucion Pira√±a", danger: "EXTREMO ‚ò¢Ô∏è", desc: "Disuelve toda materia organica." },
        { items: ["Sosa Caustica", "Aluminio"], name: "Hidrogeno Explosivo", danger: "FUEGO ‚ö°", desc: "Gas altamente inflamable." },
        { items: ["Lavandina", "Acido Muriatico"], name: "Gas Cloro", danger: "MORTAL üíÄ", desc: "Gas verde que quema pulmones." },
        { items: ["Metanol", "Sodio Metalico"], name: "Metoxido de Sodio", danger: "PELIGRO ‚ò¢Ô∏è", desc: "Liquido altamente corrosivo." },
        { items: ["Vinagre", "Bicarbonato de Sodio"], name: "Erupcion Volcanica", danger: "SEGURO ‚úÖ", desc: "Liberacion de CO2 inofensivo." },
        { items: ["Azufre", "Salitre", "Carbon"], name: "Polvora Negra", danger: "PELIGRO üî•", desc: "Mezcla pirotecnica clasica." },
        { items: ["Acido Nitrico", "Carbon"], name: "Oxidacion Violenta", danger: "FUEGO üß®", desc: "Gases toxicos rojos." },
        { items: ["Yodo", "Aluminio"], name: "Reaccion Catalitica", danger: "HUMO üü£", desc: "Humo purpura denso y fuego." },
        { items: ["Mercurio", "Aluminio"], name: "Amalgama de Al", danger: "CORROSION ‚ö†Ô∏è", desc: "Destruye el aluminio." },
        { items: ["Hielo Seco", "Lavandina"], name: "Gases de Cloro Frio", danger: "TOXICO ‚ò£Ô∏è", desc: "Peligro de asfixia quimica." },
        { items: ["Cloroformo", "Sosa Caustica"], name: "Diclorocarbeno", danger: "EXPLOSIVO üß®", desc: "Genera gases letales." }
    ];

    let selected = [];
    let saved = JSON.parse(localStorage.getItem('chem_v6')) || [];

    function init() {
        const container = document.getElementById('list');
        Object.keys(DB).sort().forEach(name => {
            const card = document.createElement('div');
            card.className = 'chem-card';
            card.id = `card-${name}`;
            card.setAttribute('data-name', cleanText(name));
            card.innerHTML = `<span>${name}</span> <button class="q-btn" onclick="openInfo(event, '${name}')">?</button>`;
            card.onclick = () => toggle(name, card);
            container.appendChild(card);
        });
        updateSaved();
    }

    function cleanText(text) {
        return text.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    }

    function filterChemicals() {
        const query = cleanText(document.getElementById('search-input').value);
        document.querySelectorAll('.chem-card').forEach(card => {
            const name = card.getAttribute('data-name');
            card.classList.toggle('hidden', !name.includes(query));
        });
    }

    function toggle(name, el) {
        if (selected.includes(name)) {
            selected = selected.filter(i => i !== name);
            el.classList.remove('active');
        } else {
            if (selected.length >= 5) return;
            selected.push(name);
            el.classList.add('active');
        }
        document.getElementById('selection-display').innerText = selected.length ? selected.join(' + ') : "Selecciona reactivos...";
        document.getElementById('mix-btn').disabled = selected.length < 2;
    }

    function handleMix() {
        const box = document.getElementById('result-box');
        const match = REACTIONS.find(r => r.items.length === selected.length && r.items.every(i => selected.includes(i)));
        box.style.display = "block";
        box.className = "result-pane";
        
        if (match) {
            if (match.danger.includes("üî¥") || match.danger.includes("üíÄ")) box.classList.add('emergency-blink');
            box.innerHTML = `
                <div style="background:var(--danger); color:white; padding:2px 5px; border-radius:4px; font-weight:bold; display:inline-block">${match.danger}</div>
                <h3 style="margin:5px 0">${match.name}</h3>
                <p>${match.desc}</p>
                <button onclick="saveRec('${match.name}', '${selected.join('+')}')" style="background:var(--accent); border:none; color:white; padding:5px; border-radius:4px; font-size:10px;">üíæ Guardar</button>
            `;
        } else {
            box.innerHTML = `<h3>Desconocido</h3><p>Riesgo potencial. No hay registros de esta mezcla exacta.</p>`;
        }
        window.scrollTo(0, document.body.scrollHeight);
    }

    function saveRec(n, c) {
        if (!saved.some(s => s.c === c)) {
            saved.push({n, c});
            localStorage.setItem('chem_v6', JSON.stringify(saved));
            updateSaved();
        }
    }

    function updateSaved() {
        const list = document.getElementById('saved-recipes');
        list.innerHTML = saved.map(s => `<div class="recipe-item"><b>${s.n}</b>: <small>${s.c}</small></div>`).join('');
    }

    function openInfo(e, name) {
        e.stopPropagation();
        const d = DB[name];
        document.getElementById('modal-data').innerHTML = `
            <h2 style="margin:0; color:var(--accent)">${name}</h2>
            <p><b>Tipo:</b> ${d.tipo} | <b>Color:</b> ${d.color}</p>
            <p><b>Uso:</b> ${d.uso}</p>
            <div style="background:#2d1a1a; padding:10px; border-radius:8px; margin-top:10px; border-left:4px solid var(--danger)">
                <h4 style="margin:0">Riesgos Directos</h4>
                <p>‚ö†Ô∏è Piel: ${d.skin} | üå¨Ô∏è Aire: ${d.air}</p>
                <p>üëÑ Ingerir: ${d.ingest}</p>
            </div>
            <p><b>üõ°Ô∏è Prevencion:</b> ${d.prev} | <b>üì¶ Envase:</b> ${d.cont}</p>
        `;
        document.getElementById('modal').style.display = 'flex';
    }

    function closeInfo() { document.getElementById('modal').style.display = 'none'; }

    function resetLab() {
        selected = [];
        document.querySelectorAll('.chem-card').forEach(c => c.classList.remove('active'));
        document.getElementById('result-box').style.display = 'none';
        document.getElementById('mix-btn').disabled = true;
        document.getElementById('selection-display').innerText = "Selecciona reactivos...";
    }

    init();
</script>
</body>
</html>
